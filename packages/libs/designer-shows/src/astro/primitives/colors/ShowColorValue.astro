---
import { type ColorSpaceName, type ColorValue } from '@noodlestan/designer-decisions';

import { DecisionValue, ColorSwatch } from '../../atoms';
import type { ShowValueProps } from '../../types';
import { ShowValueUnavailable } from '../unavailable';
import { FlexStack } from '../../layouts';

type Props = ShowValueProps & {
    color?: ColorValue;
};

const { color, value = true, viz = true, size = 'auto' } = Astro.props;

const spaces: ColorSpaceName[] | null =
    typeof value === 'boolean' && value
        ? ['rgb']
        : typeof value === 'string'
          ? [value as ColorSpaceName]
          : Array.isArray(value)
            ? (value as ColorSpaceName[])
            : null;
---

<div class:list={['dd-show-color-value', { size }]}>
    {viz && color && <ColorSwatch color={color} size={size} />}
    {!color && <ShowValueUnavailable />}
    {
        value && color && (
            <FlexStack>
                {spaces?.map(space => (
                    <DecisionValue>{color.getString(space)}</DecisionValue>
                ))}
            </FlexStack>
        )
    }
</div>

<style>
    .dd-show-color-value {
        display: flex;
        gap: var(--dd-space-gap);
    }
</style>
