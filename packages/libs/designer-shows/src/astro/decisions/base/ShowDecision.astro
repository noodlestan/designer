---
import { type ShowDecisionProps } from '../../types';
import { getDecisionComponent } from '../../meta';
import { ShowDecisionTypeUnavailable, ShowDecisionUnavailable } from '../unavailable';

type Props = ShowDecisionProps;

const { store, d, ...rest } = Astro.props;

const [, decision] = store.decision({ $name: d });
console.log(d, Boolean(decision));
const Comp = decision && getDecisionComponent(decision);

const type = decision && decision.type();
---

{decision && Comp && <Comp store={store} d={d} {...rest} />}
{decision && type && !Comp && <ShowDecisionTypeUnavailable type={type} />}
{!decision && <ShowDecisionUnavailable d={d as string} />}
